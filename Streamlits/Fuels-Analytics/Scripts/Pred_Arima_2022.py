# Importação de módulos necessários
import pandas as pd
from statsmodels.tsa.arima.model import ARIMA

# Base de dados
data = [
    {'Date': '30/12/2022', 'Valor': '82.82'}, {'Date': '29/12/2022', 'Valor': '80.96'}, {'Date': '28/12/2022', 'Valor': '81.70'}, {'Date': '27/12/2022', 'Valor': '82.45'}, {'Date': '23/12/2022', 'Valor': '82.45'}, {'Date': '22/12/2022', 'Valor': '79.58'}, {'Date': '21/12/2022', 'Valor': '80.25'}, {'Date': '20/12/2022', 'Valor': '79.45'}, {'Date': '19/12/2022', 'Valor': '81.66'}, {'Date': '16/12/2022', 'Valor': '80.20'}, {'Date': '15/12/2022', 'Valor': '82.34'}, {'Date': '14/12/2022', 'Valor': '83.33'}, {'Date': '13/12/2022', 'Valor': '80.14'}, {'Date': '12/12/2022', 'Valor': '78.00'}, {'Date': '09/12/2022', 'Valor': '76.37'}, {'Date': '08/12/2022', 'Valor': '76.02'}, {'Date': '07/12/2022', 'Valor': '77.11'}, {'Date': '06/12/2022', 'Valor': '79.92'}, {'Date': '05/12/2022', 'Valor': '83.36'}, {'Date': '02/12/2022', 'Valor': '86.54'}, {'Date': '01/12/2022', 'Valor': '86.28'}, {'Date': '30/11/2022', 'Valor': '85.61'}, {'Date': '29/11/2022', 'Valor': '83.22'}, {'Date': '28/11/2022', 'Valor': '83.50'}, {'Date': '25/11/2022', 'Valor': '83.40'}, {'Date': '24/11/2022', 'Valor': '85.59'}, {'Date': '23/11/2022', 'Valor': '85.90'}, {'Date': '22/11/2022', 'Valor': '88.65'}, {'Date': '21/11/2022', 'Valor': '88.44'}, {'Date': '18/11/2022', 'Valor': '88.93'}, {'Date': '17/11/2022', 'Valor': '91.00'}, {'Date': '16/11/2022', 'Valor': '92.61'}, {'Date': '15/11/2022', 'Valor': '94.30'}, {'Date': '14/11/2022', 'Valor': '93.59'}, {'Date': '11/11/2022', 'Valor': '96.37'}, {'Date': '10/11/2022', 'Valor': '94.25'}, {'Date': '09/11/2022', 'Valor': '93.05'}, {'Date': '08/11/2022', 'Valor': '96.85'}, {'Date': '07/11/2022', 'Valor': '99.87'}, {'Date': '04/11/2022', 'Valor': '99.53'}, {'Date': '03/11/2022', 'Valor': '95.29'}, {'Date': '02/11/2022', 'Valor': '96.07'}, {'Date': '01/11/2022', 'Valor': '95.12'}, {'Date': '31/10/2022', 'Valor': '93.30'}, {'Date': '28/10/2022', 'Valor': '94.64'}, {'Date': '27/10/2022', 'Valor': '94.17'}, {'Date': '26/10/2022', 'Valor': '92.93'}, {'Date': '25/10/2022', 'Valor': '91.76'}, {'Date': '24/10/2022', 'Valor': '91.57'}, {'Date': '21/10/2022', 'Valor': '91.82'}, {'Date': '20/10/2022', 'Valor': '91.52'}, {'Date': '19/10/2022', 'Valor': '91.34'}, {'Date': '18/10/2022', 'Valor': '89.46'}, {'Date': '17/10/2022', 'Valor': '91.04'}, {'Date': '14/10/2022', 'Valor': '92.22'}, {'Date': '13/10/2022', 'Valor': '95.16'}, {'Date': '12/10/2022', 'Valor': '93.44'}, {'Date': '11/10/2022', 'Valor': '95.17'}, {'Date': '10/10/2022', 'Valor': '97.13'}, {'Date': '07/10/2022', 'Valor': '98.88'}, {'Date': '06/10/2022', 'Valor': '95.65'}, {'Date': '05/10/2022', 'Valor': '94.35'}, {'Date': '04/10/2022', 'Valor': '93.74'}, {'Date': '03/10/2022', 'Valor': '90.68'}, {'Date': '30/09/2022', 'Valor': '88.90'}, {'Date': '29/09/2022', 'Valor': '89.41'}, {'Date': '28/09/2022', 'Valor': '89.55'}, {'Date': '27/09/2022', 'Valor': '85.97'}, {'Date': '26/09/2022', 'Valor': '82.55'}, {'Date': '23/09/2022', 'Valor': '84.29'}, {'Date': '22/09/2022', 'Valor': '90.40'}, {'Date': '21/09/2022', 'Valor': '89.86'}, {'Date': '20/09/2022', 'Valor': '89.62'}, {'Date': '19/09/2022', 'Valor': '89.43'}, {'Date': '16/09/2022', 'Valor': '89.43'}, {'Date': '15/09/2022', 'Valor': '89.28'}, {'Date': '14/09/2022', 'Valor': '92.83'}, {'Date': '13/09/2022', 'Valor': '92.04'}, {'Date': '12/09/2022', 'Valor': '93.45'}, {'Date': '09/09/2022', 'Valor': '91.68'}, {'Date': '08/09/2022', 'Valor': '87.99'}, {'Date': '07/09/2022', 'Valor': '86.83'}, {'Date': '06/09/2022', 'Valor': '91.43'}, {'Date': '05/09/2022', 'Valor': '94.22'}, {'Date': '02/09/2022', 'Valor': '93.09'}, {'Date': '01/09/2022', 'Valor': '92.24'}, {'Date': '31/08/2022', 'Valor': '96.55'}, {'Date': '30/08/2022', 'Valor': '99.34'}, {'Date': '26/08/2022', 'Valor': '101.13'}, {'Date': '25/08/2022', 'Valor': '98.81'}, {'Date': '24/08/2022', 'Valor': '99.87'}, {'Date': '23/08/2022', 'Valor': '99.49'}, {'Date': '22/08/2022', 'Valor': '95.06'}, {'Date': '19/08/2022', 'Valor': '96.45'}, {'Date': '18/08/2022', 'Valor': '96.35'}, {'Date': '17/08/2022', 'Valor': '97.22'}, {'Date': '16/08/2022', 'Valor': '95.36'}, {'Date': '15/08/2022', 'Valor': '98.25'}, {'Date': '12/08/2022', 'Valor': '103.70'}, {'Date': '11/08/2022', 'Valor': '107.19'}, {'Date': '10/08/2022', 'Valor': '105.06'}, {'Date': '09/08/2022', 'Valor': '103.81'}, {'Date': '08/08/2022', 'Valor': '103.46'}, {'Date': '05/08/2022', 'Valor': '100.31'}, {'Date': '04/08/2022', 'Valor': '97.99'}, {'Date': '03/08/2022', 'Valor': '101.82'}, {'Date': '02/08/2022', 'Valor': '106.51'}, {'Date': '01/08/2022', 'Valor': '106.09'}, {'Date': '29/07/2022', 'Valor': '111.51'}, {'Date': '28/07/2022', 'Valor': '109.68'}, {'Date': '27/07/2022', 'Valor': '109.64'}, {'Date': '26/07/2022', 'Valor': '107.32'}, {'Date': '25/07/2022', 'Valor': '108.23'}, {'Date': '22/07/2022', 'Valor': '106.77'}, {'Date': '21/07/2022', 'Valor': '112.81'}, {'Date': '20/07/2022', 'Valor': '115.86'}, {'Date': '19/07/2022', 'Valor': '114.96'}, {'Date': '18/07/2022', 'Valor': '117.27'}, {'Date': '15/07/2022', 'Valor': '112.26'}, {'Date': '14/07/2022', 'Valor': '107.74'}, {'Date': '13/07/2022', 'Valor': '107.17'}, {'Date': '12/07/2022', 'Valor': '106.98'}, {'Date': '11/07/2022', 'Valor': '114.85'}, {'Date': '08/07/2022', 'Valor': '113.95'}, {'Date': '07/07/2022', 'Valor': '113.40'}, {'Date': '06/07/2022', 'Valor': '108.54'}, {'Date': '05/07/2022', 'Valor': '110.49'}, {'Date': '04/07/2022', 'Valor': '121.80'}, {'Date': '01/07/2022', 'Valor': '119.21'}, {'Date': '30/06/2022', 'Valor': '119.78'}, {'Date': '29/06/2022', 'Valor': '120.80'}, {'Date': '28/06/2022', 'Valor': '122.21'}, {'Date': '27/06/2022', 'Valor': '119.69'}, {'Date': '24/06/2022', 'Valor': '117.36'}, {'Date': '23/06/2022', 'Valor': '114.50'}, {'Date': '22/06/2022', 'Valor': '115.54'}, {'Date': '21/06/2022', 'Valor': '118.51'}, {'Date': '20/06/2022', 'Valor': '118.25'}, {'Date': '17/06/2022', 'Valor': '119.22'}, {'Date': '16/06/2022', 'Valor': '125.78'}, {'Date': '15/06/2022', 'Valor': '124.96'}, {'Date': '14/06/2022', 'Valor': '127.02'}, {'Date': '13/06/2022', 'Valor': '128.44'}, {'Date': '10/06/2022', 'Valor': '127.44'}, {'Date': '09/06/2022', 'Valor': '128.47'}, {'Date': '08/06/2022', 'Valor': '129.20'}, {'Date': '07/06/2022', 'Valor': '126.89'}, {'Date': '06/06/2022', 'Valor': '124.99'}, {'Date': '03/06/2022', 'Valor': '125.68'}, {'Date': '01/06/2022', 'Valor': '122.20'}, {'Date': '31/05/2022', 'Valor': '125.53'}, {'Date': '30/05/2022', 'Valor': '123.01'}, {'Date': '27/05/2022', 'Valor': '121.19'}, {'Date': '26/05/2022', 'Valor': '119.81'}, {'Date': '25/05/2022', 'Valor': '116.41'}, {'Date': '24/05/2022', 'Valor': '115.77'}, {'Date': '23/05/2022', 'Valor': '115.13'}, {'Date': '20/05/2022', 'Valor': '113.63'}, {'Date': '19/05/2022', 'Valor': '113.22'}, {'Date': '18/05/2022', 'Valor': '110.04'}, {'Date': '17/05/2022', 'Valor': '112.89'}, {'Date': '16/05/2022', 'Valor': '114.86'}, {'Date': '13/05/2022', 'Valor': '112.12'}, {'Date': '12/05/2022', 'Valor': '108.06'}, {'Date': '11/05/2022', 'Valor': '107.70'}, {'Date': '10/05/2022', 'Valor': '102.61'}, {'Date': '09/05/2022', 'Valor': '106.67'}, {'Date': '06/05/2022', 'Valor': '113.86'}, {'Date': '05/05/2022', 'Valor': '112.11'}, {'Date': '04/05/2022', 'Valor': '110.53'}, {'Date': '03/05/2022', 'Valor': '104.94'}, {'Date': '02/05/2022', 'Valor': '108.36'}, {'Date': '29/04/2022', 'Valor': '108.36'}, {'Date': '28/04/2022', 'Valor': '105.78'}, {'Date': '27/04/2022', 'Valor': '103.30'}, {'Date': '26/04/2022', 'Valor': '102.89'}, {'Date': '25/04/2022', 'Valor': '99.27'}, {'Date': '22/04/2022', 'Valor': '105.15'}, {'Date': '21/04/2022', 'Valor': '107.20'}, {'Date': '20/04/2022', 'Valor': '105.05'}, {'Date': '19/04/2022', 'Valor': '105.49'}, {'Date': '18/04/2022', 'Valor': '110.83'}, {'Date': '14/04/2022', 'Valor': '110.83'}, {'Date': '13/04/2022', 'Valor': '108.49'}, {'Date': '12/04/2022', 'Valor': '104.42'}, {'Date': '11/04/2022', 'Valor': '97.92'}, {'Date': '08/04/2022', 'Valor': '101.26'}, {'Date': '07/04/2022', 'Valor': '99.83'}, {'Date': '06/04/2022', 'Valor': '100.81'}, {'Date': '05/04/2022', 'Valor': '106.60'}, {'Date': '04/04/2022', 'Valor': '108.15'}, {'Date': '01/04/2022', 'Valor': '106.13'}, {'Date': '31/03/2022', 'Valor': '107.29'}, {'Date': '30/03/2022', 'Valor': '115.59'}, {'Date': '29/03/2022', 'Valor': '112.79'}, {'Date': '28/03/2022', 'Valor': '114.50'}, {'Date': '25/03/2022', 'Valor': '122.67'}, {'Date': '24/03/2022', 'Valor': '123.98'}, {'Date': '23/03/2022', 'Valor': '127.52'}, {'Date': '22/03/2022', 'Valor': '121.53'}, {'Date': '21/03/2022', 'Valor': '122.29'}, {'Date': '18/03/2022', 'Valor': '114.32'}, {'Date': '17/03/2022', 'Valor': '113.50'}, {'Date': '16/03/2022', 'Valor': '104.61'}, {'Date': '15/03/2022', 'Valor': '105.14'}, {'Date': '14/03/2022', 'Valor': '110.39'}, {'Date': '11/03/2022', 'Valor': '118.11'}, {'Date': '10/03/2022', 'Valor': '114.54'}, {'Date': '09/03/2022', 'Valor': '116.58'}, {'Date': '08/03/2022', 'Valor': '133.18'}, {'Date': '07/03/2022', 'Valor': '129.02'}, {'Date': '04/03/2022', 'Valor': '123.86'}, {'Date': '03/03/2022', 'Valor': '115.36'}, {'Date': '02/03/2022', 'Valor': '118.94'}, {'Date': '01/03/2022', 'Valor': '110.93'}, {'Date': '28/02/2022', 'Valor': '103.08'}, {'Date': '25/02/2022', 'Valor': '98.56'}, {'Date': '24/02/2022', 'Valor': '101.29'}, {'Date': '23/02/2022', 'Valor': '99.29'}, {'Date': '22/02/2022', 'Valor': '98.73'}, {'Date': '21/02/2022', 'Valor': '98.95'}, {'Date': '18/02/2022', 'Valor': '96.18'}, {'Date': '17/02/2022', 'Valor': '95.28'}, {'Date': '16/02/2022', 'Valor': '97.44'}, {'Date': '15/02/2022', 'Valor': '98.43'}, {'Date': '14/02/2022', 'Valor': '101.66'}, {'Date': '11/02/2022', 'Valor': '97.50'}, {'Date': '10/02/2022', 'Valor': '96.37'}, {'Date': '09/02/2022', 'Valor': '94.95'}, {'Date': '08/02/2022', 'Valor': '96.07'}, {'Date': '07/02/2022', 'Valor': '97.28'}, {'Date': '04/02/2022', 'Valor': '96.86'}, {'Date': '03/02/2022', 'Valor': '92.99'}, {'Date': '02/02/2022', 'Valor': '91.43'}, {'Date': '01/02/2022', 'Valor': '90.24'}, {'Date': '31/01/2022', 'Valor': '92.35'}, {'Date': '28/01/2022', 'Valor': '91.47'}, {'Date': '27/01/2022', 'Valor': '90.70'}, {'Date': '26/01/2022', 'Valor': '91.22'}, {'Date': '25/01/2022', 'Valor': '89.49'}, {'Date': '24/01/2022', 'Valor': '87.74'}, {'Date': '21/01/2022', 'Valor': '89.75'}, {'Date': '20/01/2022', 'Valor': '89.75'}, {'Date': '19/01/2022', 'Valor': '89.64'}, {'Date': '18/01/2022', 'Valor': '88.83'}, {'Date': '17/01/2022', 'Valor': '87.82'}, {'Date': '14/01/2022', 'Valor': '87.17'}, {'Date': '13/01/2022', 'Valor': '85.80'}, {'Date': '12/01/2022', 'Valor': '85.83'}, {'Date': '11/01/2022', 'Valor': '84.98'}, {'Date': '10/01/2022', 'Valor': '81.56'}, {'Date': '07/01/2022', 'Valor': '82.28'}, {'Date': '06/01/2022', 'Valor': '81.99'}, {'Date': '05/01/2022', 'Valor': '80.60'}, {'Date': '04/01/2022', 'Valor': '79.39'}, {'Date': '03/01/2022', 'Valor': '78.25'}
]

# Formatação para cada item
for entry in data:
    entry['Date'] = pd.to_datetime(entry['Date'], format='%d/%m/%Y')
    entry['Valor'] = float(entry['Valor'])

# Cria um DataFrame a partir dos dados
df = pd.DataFrame(data)

# Ordena o DataFrame por data
df = df.sort_values(by='Date')

# Define a data como índice
df = df.set_index('Date')

# Ajusta o modelo ARIMA
model = ARIMA(df['Valor'], order=(1, 1, 1))
result = model.fit()

# Faz a previsão para '02/01/2023'
forecast = result.get_forecast(steps=1)

predicted_value = forecast.predicted_mean.iloc[0]
confidence_interval_lower = forecast.conf_int().iloc[0][0]
confidence_interval_upper = forecast.conf_int().iloc[0][1]
std_errors = forecast.se_mean.iloc[0]


# Geração de CSV para visualização posterior —>

# Salvando em CSV
file = []
file.append({'Valor_predição':predicted_value, 'Intervalo de Confiança L': confidence_interval_lower, 'Intervalo de Confiança U': confidence_interval_upper, 'Erro Padrão das Previsões': std_errors})

# Adiciona lista em um DataFrame
df_predict = pd.DataFrame(file)

# Salva o DataFrame em um arquivo CSV
df_predict.to_csv('../Datas/Pred-Arima_2022.csv', index=False, sep=';')

# Geração de CSV para visualização posterior —>


# Imprime a previsão
print(f"Previsão para '02/01/2023': {predicted_value}")

# Com esse código, geramos um CSV para visualização posterior
